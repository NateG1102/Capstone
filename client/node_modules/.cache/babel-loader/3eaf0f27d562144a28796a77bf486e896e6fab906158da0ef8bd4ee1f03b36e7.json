{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\natia\\\\Capstone\\\\client\\\\src\\\\components\\\\StockChatBox.js\",\n  _s = $RefreshSig$();\nimport { useRef, useState, useEffect, useMemo } from 'react';\nimport { askChat } from '../services/chatAPI';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function StockChatBox({\n  symbol,\n  rows = []\n}) {\n  _s();\n  const [messages, set] = useState([{\n    role: 'assistant',\n    content: `Ask me about ${symbol}. Educational only — not financial advice.`\n  }]);\n  const [typing, setTyping] = useState(false);\n  const inputRef = useRef(null);\n  const logRef = useRef(null);\n  const context = useMemo(() => {\n    var _rows$at;\n    if (!rows.length) return '';\n    const last = (_rows$at = rows.at(-1)) === null || _rows$at === void 0 ? void 0 : _rows$at.close;\n    const w = rows.slice(-7).map(r => r.close);\n    const change = w.length > 1 ? (w.at(-1) - w[0]) / w[0] * 100 : 0;\n    return `Latest close ≈ ${last}. ~1w change ≈ ${Number.isFinite(change) ? change.toFixed(2) : '0.00'}%.`;\n  }, [rows]);\n  useEffect(() => {\n    var _logRef$current;\n    (_logRef$current = logRef.current) === null || _logRef$current === void 0 ? void 0 : _logRef$current.scrollTo({\n      top: logRef.current.scrollHeight,\n      behavior: 'smooth'\n    });\n  }, [messages, typing]);\n  async function send() {\n    const text = inputRef.current.value.trim();\n    if (!text) return;\n    inputRef.current.value = '';\n    set(m => [...m, {\n      role: 'user',\n      content: text\n    }]);\n    setTyping(true);\n    try {\n      var _r$data;\n      const r = await askChat(text, {\n        symbol,\n        context\n      });\n      const reply = (r === null || r === void 0 ? void 0 : (_r$data = r.data) === null || _r$data === void 0 ? void 0 : _r$data.content) || 'No reply.';\n      set(m => [...m, {\n        role: 'assistant',\n        content: reply\n      }]);\n    } catch {\n      set(m => [...m, {\n        role: 'assistant',\n        content: 'Chat temporarily unavailable.'\n      }]);\n    } finally {\n      setTyping(false);\n    }\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"stock-chatbox\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"stock-chatlog\",\n      ref: logRef,\n      children: [messages.map((m, i) => /*#__PURE__*/_jsxDEV(\"div\", {\n        className: `stock-message ${m.role}`,\n        children: m.content\n      }, i, false, {\n        fileName: _jsxFileName,\n        lineNumber: 45,\n        columnNumber: 11\n      }, this)), typing && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"stock-message assistant\",\n        children: \"\\u2026\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 47,\n        columnNumber: 20\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 43,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"stock-chatinput\",\n      children: [/*#__PURE__*/_jsxDEV(\"input\", {\n        ref: inputRef,\n        placeholder: `Ask about ${symbol}…`,\n        onKeyDown: e => e.key === 'Enter' && send()\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 50,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: send,\n        children: \"Send\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 55,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 49,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 42,\n    columnNumber: 5\n  }, this);\n}\n_s(StockChatBox, \"+4BjjLeInWTpsOZW73cSLENQqeo=\");\n_c = StockChatBox;\nvar _c;\n$RefreshReg$(_c, \"StockChatBox\");","map":{"version":3,"names":["useRef","useState","useEffect","useMemo","askChat","jsxDEV","_jsxDEV","StockChatBox","symbol","rows","_s","messages","set","role","content","typing","setTyping","inputRef","logRef","context","_rows$at","length","last","at","close","w","slice","map","r","change","Number","isFinite","toFixed","_logRef$current","current","scrollTo","top","scrollHeight","behavior","send","text","value","trim","m","_r$data","reply","data","className","children","ref","i","fileName","_jsxFileName","lineNumber","columnNumber","placeholder","onKeyDown","e","key","onClick","_c","$RefreshReg$"],"sources":["C:/Users/natia/Capstone/client/src/components/StockChatBox.js"],"sourcesContent":["import { useRef, useState, useEffect, useMemo } from 'react';\r\nimport { askChat } from '../services/chatAPI';\r\n\r\nexport default function StockChatBox({ symbol, rows = [] }) {\r\n  const [messages, set] = useState([\r\n    { role: 'assistant', content: `Ask me about ${symbol}. Educational only — not financial advice.` }\r\n  ]);\r\n  const [typing, setTyping] = useState(false);\r\n  const inputRef = useRef(null);\r\n  const logRef = useRef(null);\r\n\r\n  const context = useMemo(() => {\r\n    if (!rows.length) return '';\r\n    const last = rows.at(-1)?.close;\r\n    const w = rows.slice(-7).map(r => r.close);\r\n    const change = w.length > 1 ? ((w.at(-1) - w[0]) / w[0]) * 100 : 0;\r\n    return `Latest close ≈ ${last}. ~1w change ≈ ${Number.isFinite(change) ? change.toFixed(2) : '0.00'}%.`;\r\n  }, [rows]);\r\n\r\n  useEffect(() => {\r\n    logRef.current?.scrollTo({ top: logRef.current.scrollHeight, behavior: 'smooth' });\r\n  }, [messages, typing]);\r\n\r\n  async function send() {\r\n    const text = inputRef.current.value.trim();\r\n    if (!text) return;\r\n    inputRef.current.value = '';\r\n    set(m => [...m, { role: 'user', content: text }]);\r\n    setTyping(true);\r\n    try {\r\n      const r = await askChat(text, { symbol, context });\r\n      const reply = r?.data?.content || 'No reply.';\r\n      set(m => [...m, { role: 'assistant', content: reply }]);\r\n    } catch {\r\n      set(m => [...m, { role: 'assistant', content: 'Chat temporarily unavailable.' }]);\r\n    } finally {\r\n      setTyping(false);\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div className=\"stock-chatbox\">\r\n      <div className=\"stock-chatlog\" ref={logRef}>\r\n        {messages.map((m, i) => (\r\n          <div key={i} className={`stock-message ${m.role}`}>{m.content}</div>\r\n        ))}\r\n        {typing && <div className=\"stock-message assistant\">…</div>}\r\n      </div>\r\n      <div className=\"stock-chatinput\">\r\n        <input\r\n          ref={inputRef}\r\n          placeholder={`Ask about ${symbol}…`}\r\n          onKeyDown={(e) => e.key === 'Enter' && send()}\r\n        />\r\n        <button onClick={send}>Send</button>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}